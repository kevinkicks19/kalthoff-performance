---
import Layout from '../layouts/Layout.astro';
import { parseTestimonialsFromCSV, getDisplayTestimonials } from '../lib/testimonials';

// Load testimonials from CSV
const testimonials = await parseTestimonialsFromCSV();

// Get 5 random testimonials to display
const displayTestimonials = getDisplayTestimonials(testimonials, 5);
// Welcome to Astro! Wondering what to do next? Check out the Astro documentation at https://docs.astro.build
// Don't want to use any of this? Delete everything in this file, the `assets`, `components`, and `layouts` directories, and start fresh.
---

<Layout title="Kalthoff Performance - Your Premier Fitness Destination">
	<!-- Hero Section with Circular Navigation -->
	<section class="relative min-h-screen bg-black overflow-hidden flex items-center justify-center">
		<!-- Background Pattern -->
		<div class="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0wIDBoNjB2NjBIMHoiLz48cGF0aCBkPSJNMzYuMzY0IDM2LjM2NGwtMzYuMzY0IDM2LjM2NHYtMzYuMzY0aDM2LjM2NHptLTM2LjM2NCAwTDM2LjM2NCAwaDM2LjM2NHYzNi4zNjRIMHoiLz48L2c+PC9zdmc+')] opacity-5"></div>
		
		<!-- Circular Navigation -->
		<div class="relative w-[800px] h-[800px] flex items-center justify-center">
			<!-- Center Image -->
			<div class="absolute w-[500px] h-[500px] rounded-full overflow-hidden border-4 border-white shadow-lg animate-fade-in z-10">
				<img
					src="/images/kalthoffMedal.jpg"
					alt="Olympic Gold Medal Celebration"
					class="w-full h-full object-cover"
				/>
				<div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent flex items-end justify-center pb-8">
					
				</div>
			</div>

			<!-- Navigation Buttons -->
			<div class="absolute w-full h-full animate-spin-in">
				<!-- Top -->
				<a href="/services/performance-programming" class="absolute top-[2%] left-1/2 transform -translate-x-1/2 w-40 h-40 bg-white/70 backdrop-blur-sm rounded-full flex items-center justify-center shadow-lg hover:bg-black hover:text-white transition-all duration-300">
					<span class="text-xl font-bebas tracking-wider text-center px-4">Performance Training</span>
				</a>
				<!-- Top Right -->
				<a href="/services/rehab-programming" class="absolute top-[20%] right-[5%] transform w-40 h-40 bg-white/70 backdrop-blur-sm rounded-full flex items-center justify-center shadow-lg hover:bg-black hover:text-white transition-all duration-300">
					<span class="text-xl font-bebas tracking-wider text-center px-4">Rehab Training</span>
				</a>
				<!-- Bottom Right -->
				<a href="/services/daily-programming" class="absolute bottom-[20%] right-[5%] transform w-40 h-40 bg-white/70 backdrop-blur-sm rounded-full flex items-center justify-center shadow-lg hover:bg-black hover:text-white transition-all duration-300">
					<span class="text-xl font-bebas tracking-wider text-center px-4">Daily Training</span>
				</a>
				<!-- Bottom -->
				<a href="/services" class="absolute bottom-[2%] left-1/2 transform -translate-x-1/2 w-40 h-40 bg-white/70 backdrop-blur-sm rounded-full flex items-center justify-center shadow-lg hover:bg-black hover:text-white transition-all duration-300">
					<span class="text-xl font-bebas tracking-wider text-center px-4">Other Services</span>
				</a>
				<!-- Bottom Left -->
				<a href="/contact" class="absolute bottom-[20%] left-[5%] transform w-40 h-40 bg-white/70 backdrop-blur-sm rounded-full flex items-center justify-center shadow-lg hover:bg-black hover:text-white transition-all duration-300">
					<span class="text-xl font-bebas tracking-wider">Contact</span>
				</a>
				<!-- Top Left -->
				<a href="/about" class="absolute top-[20%] left-[5%] transform w-40 h-40 bg-white/70 backdrop-blur-sm rounded-full flex items-center justify-center shadow-lg hover:bg-black hover:text-white transition-all duration-300">
					<span class="text-xl font-bebas tracking-wider">About</span>
				</a>
			</div>
		</div>
	</section>

	<!-- Testimonials Section -->
	<section class="py-24 bg-white">
		<div class="container mx-auto px-4">
			<h2 class="text-5xl font-bebas text-center mb-16 tracking-wider">What Our Athletes Say</h2>
			
			<!-- Testimonial Slideshow -->
			<div class="relative max-w-4xl mx-auto">
				<!-- Testimonials Container -->
				<div class="overflow-hidden">
					<div class="flex transition-transform duration-500" id="testimonialSlider">
						{displayTestimonials.map((testimonial, index) => (
							<div class="w-full flex-shrink-0 px-6">
								<blockquote class="text-center">
									<p class="text-xl font-inter text-gray-700 mb-8 italic">"{testimonial.content}"</p>
									<footer class="flex flex-col items-center">
										<div class="w-16 h-16 bg-gray-200 rounded-full mb-4 flex items-center justify-center overflow-hidden">
											<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gray-500" viewBox="0 0 20 20" fill="currentColor">
												<path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
											</svg>
										</div>
										<cite class="font-bebas text-xl tracking-wide">{testimonial.name}</cite>
										<span class="text-gray-600 font-inter">{testimonial.title}</span>
									</footer>
								</blockquote>
							</div>
						))}
					</div>
				</div>

				<!-- Navigation Buttons -->
				<button class="absolute left-0 top-1/2 -translate-y-1/2 -translate-x-12 bg-black text-white w-10 h-10 rounded-full flex items-center justify-center hover:bg-gray-800 transition-colors" onclick="prevSlide()">
					<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
					</svg>
				</button>
				<button class="absolute right-0 top-1/2 -translate-y-1/2 translate-x-12 bg-black text-white w-10 h-10 rounded-full flex items-center justify-center hover:bg-gray-800 transition-colors" onclick="nextSlide()">
					<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
					</svg>
				</button>

				<!-- Dots -->
				<div class="flex justify-center mt-8 space-x-2">
					{displayTestimonials.map((_, index) => (
						<button class={`w-3 h-3 rounded-full ${index === 0 ? 'bg-black' : 'bg-gray-300'}`} onclick={`goToSlide(${index})`}></button>
					))}
				</div>
			</div>
		</div>
	</section>

	<!-- CTA Section -->
	<section class="py-20 bg-black text-white">
		<div class="container mx-auto px-4 text-center">
			<h2 class="text-6xl font-bebas mb-8 tracking-wider">Ready to Start Your Fitness Journey?</h2>
			<p class="text-2xl mb-8 text-gray-300 font-inter font-light tracking-wide">Join us today and transform your life through fitness</p>
			<a href="/contact" class="bg-white text-black px-8 py-3 rounded-full text-lg font-bebas tracking-wider hover:bg-gray-200 transition duration-300">
				Get Started Now
			</a>
		</div>
	</section>
</Layout>

<script define:vars={{ testimonialCount: displayTestimonials.length }}>
	let currentSlide = 0;
	const slider = document.getElementById('testimonialSlider');
	const dots = document.querySelectorAll('.flex.justify-center.mt-8.space-x-2 button');
	const totalSlides = testimonialCount;

	function updateSlider() {
		if (slider) {
			slider.style.transform = `translateX(-${currentSlide * 100}%)`;
			// Update dots
			dots.forEach((dot, index) => {
				dot.classList.toggle('bg-black', index === currentSlide);
				dot.classList.toggle('bg-gray-300', index !== currentSlide);
			});
		}
	}

	function nextSlide() {
		currentSlide = (currentSlide + 1) % totalSlides;
		updateSlider();
	}

	function prevSlide() {
		currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
		updateSlider();
	}

	function goToSlide(index) {
		currentSlide = index;
		updateSlider();
	}

	// Auto advance slides every 7 seconds
	setInterval(nextSlide, 7000);
</script>